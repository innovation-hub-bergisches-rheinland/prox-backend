<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<migration xmlns="http://ebean-orm.github.io/xml/ns/dbmigration">
    <changeSet type="apply">
        <createTable name="discipline_entity" identityType="external" pkName="pk_discipline_entity">
            <column name="key" type="varchar" primaryKey="true"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="lecturer_entity" identityType="external" pkName="pk_lecturer_entity">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="user_id" type="uuid"/>
            <column name="affiliation" type="varchar"/>
            <column name="subject" type="varchar"/>
            <column name="vita" type="varchar"/>
            <column name="room" type="varchar"/>
            <column name="consultation_hour" type="varchar"/>
            <column name="email" type="varchar"/>
            <column name="telephone" type="varchar"/>
            <column name="homepage" type="varchar"/>
            <column name="college_page" type="varchar"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="lecturer_entity_tags" pkName="pk_lecturer_entity_tags">
            <column name="lecturer_entity_id" type="uuid" notnull="true" references="lecturer_entity.id" foreignKeyName="fk_lecturer_entity_tags_lecturer_entity_id" foreignKeyIndex="ix_lecturer_entity_tags_lecturer_entity_id"/>
            <column name="value" type="uuid" notnull="true"/>
        </createTable>
        <createTable name="lecturer_entity_publications" pkName="pk_lecturer_entity_publications">
            <column name="lecturer_entity_id" type="uuid" notnull="true" references="lecturer_entity.id" foreignKeyName="fk_lecturer_entity_publications_lecturer_entity_id" foreignKeyIndex="ix_lecturer_entity_publications_lecturer_entity_id"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="module_entity" identityType="external" pkName="pk_module_entity">
            <column name="key" type="varchar" primaryKey="true"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="active" type="boolean" defaultValue="false" notnull="true"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="module_entity_disciplines" pkName="pk_module_entity_disciplines">
            <column name="module_entity_key" type="varchar" notnull="true" references="module_entity.key" foreignKeyName="fk_module_entity_disciplines_module_entity_key" foreignKeyIndex="ix_module_entity_disciplines_module_entity_key"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="organization_entity" identityType="external" pkName="pk_organization_entity">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="founding_date" type="varchar"/>
            <column name="number_of_employees" type="varchar"/>
            <column name="homepage" type="varchar"/>
            <column name="contact_email" type="varchar"/>
            <column name="vita" type="varchar"/>
            <column name="headquarter" type="varchar"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="organization_entity_quarters" pkName="pk_organization_entity_quarters">
            <column name="organization_entity_id" type="uuid" notnull="true" references="organization_entity.id" foreignKeyName="fk_organization_entity_quarters_organization_entity_id" foreignKeyIndex="ix_organization_entity_quarters_organization_entity_id"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="organization_entity_social_media" pkName="pk_organization_entity_social_media">
            <column name="organization_entity_id" type="uuid" notnull="true" references="organization_entity.id" foreignKeyName="fk_organization_entity_social_media_organization_entity_id" foreignKeyIndex="ix_organization_entity_social_media_organization_entity_id"/>
            <column name="mkey" type="varchar" notnull="true"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="organization_entity_tags" pkName="pk_organization_entity_tags">
            <column name="organization_entity_id" type="uuid" notnull="true" references="organization_entity.id" foreignKeyName="fk_organization_entity_tags_organization_entity_id" foreignKeyIndex="ix_organization_entity_tags_organization_entity_id"/>
            <column name="value" type="uuid" notnull="true"/>
        </createTable>
        <createTable name="organization_membership_entity" pkName="pk_organization_membership_entity">
            <column name="organization_id" type="uuid" primaryKey="true"/>
            <column name="user_id" type="uuid" primaryKey="true"/>
            <column name="organization_entity_id" type="uuid" notnull="true" references="organization_entity.id" foreignKeyName="fk_organization_membership_entity_organization_entity_id" foreignKeyIndex="ix_organization_membership_entity_organization_entity_id"/>
            <column name="role" type="varchar(6)" notnull="true" checkConstraint="check ( role in ('MEMBER','ADMIN'))" checkConstraintName="ck_organization_membership_entity_role"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="project_entity" identityType="external" pkName="pk_project_entity">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="creator" type="uuid" notnull="true"/>
            <column name="organization" type="uuid"/>
            <column name="title" type="varchar" notnull="true"/>
            <column name="summary" type="varchar"/>
            <column name="description" type="varchar"/>
            <column name="requirement" type="varchar"/>
            <column name="state" type="varchar(9)" checkConstraint="check ( state in ('PROPOSED','ARCHIVED','STALE','OFFERED','RUNNING','COMPLETED'))" checkConstraintName="ck_project_entity_state"/>
            <column name="updated_at" type="timestamp"/>
            <column name="time_box_start" type="date"/>
            <column name="time_box_end" type="date"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="project_entity_disciplines" pkName="pk_project_entity_disciplines">
            <column name="project_entity_id" type="uuid" notnull="true" references="project_entity.id" foreignKeyName="fk_project_entity_disciplines_project_entity_id" foreignKeyIndex="ix_project_entity_disciplines_project_entity_id"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="project_entity_modules" pkName="pk_project_entity_modules">
            <column name="project_entity_id" type="uuid" notnull="true" references="project_entity.id" foreignKeyName="fk_project_entity_modules_project_entity_id" foreignKeyIndex="ix_project_entity_modules_project_entity_id"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="project_entity_supervisors" pkName="pk_project_entity_supervisors">
            <column name="project_entity_id" type="uuid" notnull="true" references="project_entity.id" foreignKeyName="fk_project_entity_supervisors_project_entity_id" foreignKeyIndex="ix_project_entity_supervisors_project_entity_id"/>
            <column name="value" type="uuid" notnull="true"/>
        </createTable>
        <createTable name="project_entity_tags" pkName="pk_project_entity_tags">
            <column name="project_entity_id" type="uuid" notnull="true" references="project_entity.id" foreignKeyName="fk_project_entity_tags_project_entity_id" foreignKeyIndex="ix_project_entity_tags_project_entity_id"/>
            <column name="value" type="uuid" notnull="true"/>
        </createTable>
        <createTable name="tag_entity" identityType="external" pkName="pk_tag_entity">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="tag" type="varchar" notnull="true" unique="uq_tag_entity_tag"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="user_entity" identityType="external" pkName="pk_user_entity">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="email" type="varchar" notnull="true"/>
            <column name="version" type="bigint" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
    </changeSet>
</migration>